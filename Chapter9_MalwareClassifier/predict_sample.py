# Script 2: Predict from New Sample File
import pandas as pd
import joblib
import os

MODEL_PATH = "model/malware_classifier.pkl"
SAMPLE_PATH = "test_samples/sample_features.csv"

# === Step 1: Load saved model ===
if not os.path.exists(MODEL_PATH):
    print(f"[x] Trained model not found at: {MODEL_PATH}")
    exit()

print(f"Loading trained model from: {MODEL_PATH}")
model = joblib.load(MODEL_PATH)

# === Step 2: Load sample input ===
if not os.path.exists(SAMPLE_PATH):
    print(f"[x] Sample file not found: {SAMPLE_PATH}")
    exit()

print(f"Loading sample features from: {SAMPLE_PATH}")
sample_df = pd.read_csv(SAMPLE_PATH)

# === Step 3: Make predictions ===
predictions = model.predict(sample_df)

# === Step 4: Output Results ===
print("Prediction Results:")
for i, pred in enumerate(predictions):
    label = "MALICIOUS" if pred == 1 else "BENIGN"
    print(f"Sample {i+1}: {label}")





